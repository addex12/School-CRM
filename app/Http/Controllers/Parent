<?php

namespace App\Http\Controllers;

use App\Models\Survey;
use App\Models\SurveyResponse;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Auth;

class ParentController extends Controller
{
    public function index()
    {
        // Display the parent dashboard
    }

    public function showSurveys()
    {
        // Fetch and display active surveys for the parent
        $surveys = Survey::where('is_active', true)->get();
        return view('parent.surveys', compact('surveys'));
    }

    public function submitSurvey(Request $request, $surveyId)
    {
        // Validate and store survey responses
        $request->validate([
            'responses' => 'required|array',
        ]);

        $surveyResponse = new SurveyResponse();
        $surveyResponse->survey_id = $surveyId;
        $surveyResponse->parent_id = Auth::id();
        $surveyResponse->responses = json_encode($request->responses);
        $surveyResponse->save();

        return redirect()->back()->with('success', 'Survey submitted successfully.');
    }

    public function feedback(Request $request)
    {
        // Handle feedback submission
        $request->validate([
            'message' => 'required|string|max:255',
        ]);

        // Logic to save feedback
        // ...

        return redirect()->back()->with('success', 'Feedback submitted successfully.');
    }

    public function chat()
    {
        // Display chat interface
    }
}